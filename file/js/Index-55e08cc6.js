import{g as re,M as ce}from"./getAssetsFile-9c9ffaf3.js";import{_ as q,B as d,F as de,u as me,M as pe,J as ve,V as ge,T as fe,U as _e,W as he,a as K,L as M}from"./index-f2ab0033.js";import{B as V}from"./Border-16110d38.js";import{T as be,b as ye}from"./UpgradeNft-89455159.js";import{u as P}from"./vue-i18n-e0b4ebde.js";/* empty css                                                          */import{a9 as Q,az as l,Z as m,b1 as n,a0 as t,a7 as r,D as a,a6 as p,K as s,r as u,w as De,ap as Z,h as F,$ as L,_ as i,O as Be,aC as we,aA as xe}from"./@vue-4a3654e3.js";import{h as Fe,l as Ce}from"./index-a39be7cb.js";import{a as j,b as ke}from"./format-f8821988.js";import{b as Se,a as Te,g as Ae}from"./GoldCoin-5f9fc6b0.js";import{f as Ee,b as Ie,g as Ne}from"./Fragment-3ef7362b.js";import{t as $e}from"./index-fb104491.js";import{u as Ue}from"./vue-router-9c8b6c7f.js";import"./pinia-117a262d.js";import"./vue-demi-7aca303d.js";import"./@metamask-5fe78728.js";import"./@ethersproject-af74bb15.js";import"./js-sha3-1704859c.js";import"./hash.js-adcfb37a.js";import"./minimalistic-assert-770ac730.js";import"./inherits-878ccdf9.js";import"./bech32-20d6ea16.js";import"./@walletconnect-a7c9cb01.js";import"./is-typedarray-816496c7.js";import"./query-string-863c9c8a.js";import"./strict-uri-encode-39743d5a.js";import"./decode-uri-component-96b74898.js";import"./split-on-first-dea6fdb0.js";import"./typedarray-to-buffer-512de52f.js";import"./detect-browser-84fc1d8c.js";import"./qrcode-f7c04bee.js";import"./isarray-0a73c961.js";import"./buffer-8016aac3.js";import"./base64-js-c17a52db.js";import"./ieee754-480627a8.js";import"./dijkstrajs-322a599c.js";import"./copy-to-clipboard-53658741.js";import"./toggle-selection-dd807a76.js";import"./preact-c2ca5e76.js";import"./process-85dbfe57.js";import"./@intlify-79ae61b4.js";import"./vue-896067e7.js";/* empty css                                                         */import"./public-dcfc16e7.js";import"./qs-a1059fb7.js";import"./side-channel-0320a11a.js";import"./get-intrinsic-376f1f3c.js";import"./has-symbols-eb4acc8a.js";import"./function-bind-3c0fdd0c.js";import"./has-6f12dd3c.js";import"./call-bind-9097bd02.js";import"./object-inspect-39034d5e.js";import"./dayjs-b5f1d6b3.js";import"./axios-5aeb6a83.js";const He={class:"content"},Me={class:"card"},Le={class:"handler"},Ve=Q({__name:"SuccessDialog",props:{show:{type:Boolean,default:!1}},emits:["close","navigateTo"],setup(y,{emit:o}){const{t:c}=P(),C=()=>{o("close")},E=()=>{o("navigateTo")};return(v,I)=>(l(),m(de,{show:y.show,onClose:C,title:a(c)("\u606D\u559C\u83B7\u5F97\u76F2\u76D2")},{default:n(()=>[t("div",He,[t("div",Me,[r(V,{mark:!1,border:!1,img:a(re)("global/blindBox.gif")},null,8,["img"])]),t("div",Le,[r(d,{onClick:E},{default:n(()=>[p(s(a(c)("\u5F00\u542F\u76F2\u76D2")),1)]),_:1}),t("div",{class:"tips",onClick:C},s(a(c)("\u6211\u77E5\u9053\u4E86")),1)])])]),_:1},8,["show","title"]))}});var Oe=q(Ve,[["__scopeId","data-v-3b05f073"]]);const Ge=y=>(we("data-v-7681bf99"),y=y(),xe(),y),Je={class:"blind-box"},Re={class:"top-block"},We={class:"base-box"},ze={class:"info"},Ke={class:"need"},Ze={class:"value"},je=Ge(()=>t("div",{class:"item-center"},[t("div",{class:"and-pic"},[t("img",{src:ce})])],-1)),qe={class:"base-box"},Pe={class:"info"},Qe={class:"need"},Xe={class:"value"},Ye={class:"bottom-block"},et={key:0,class:"base-tips",style:{color:"rgba(230, 241, 255, 0.6500)"}},tt={class:"base-active-text"},at={key:1,class:"base-tips",style:{color:"rgba(230, 241, 255, 0.6500)"}},ot={class:"base-active-text"},st={class:"btn-block"},ut={class:"flex"},lt={class:"composeing"},nt={style:{display:"flex","align-items":"center"}},it={style:{"margin-left":"5px"}},rt={style:{display:"flex","align-items":"center"}},ct={style:{"margin-left":"5px"}},dt={class:"base-tips"},mt=Q({__name:"Index",setup(y){const{t:o}=P(),c=me(),C=Ue(),E=()=>{window.open("")},v=u(!1),I=async()=>{try{const e=await Ee(c.address);v.value=e}catch(e){console.log("\u672A\u77E5\u9519\u8BEF",e)}},f=u(""),g=u(""),_=u(!1),h=u("success"),X=()=>{window.open(`${ve}${g.value}`)};De(_,e=>{setTimeout(()=>{e&&(_.value=!1)},3e3)});const k=u(!1),Y=async()=>{try{k.value=!0;const e=await Ie();e.from&&(await e.wait(2),await I(),f.value=o("\u6388\u6743\u6210\u529F"),g.value=e.hash,h.value="success"),k.value=!1}catch(e){k.value=!1,f.value=o("\u6388\u6743\u5931\u8D25"),g.value=o("\u7528\u6237\u53D6\u6D88\u4E86\u6388\u6743"),h.value="error",console.log("\u6388\u6743\u76F2\u76D2\u5931\u8D25",e)}_.value=!0};Z(()=>{I(),O()});const b=u(!1),O=async()=>{try{const e=await Se(c.address);Number(e.toString())>0?b.value=!0:b.value=!1}catch(e){console.log("\u672A\u77E5\u9519\u8BEF",e)}},S=u(!1),ee=async()=>{try{S.value=!0;const e=await Te();e.from&&(await e.wait(2),f.value=o("\u6388\u6743\u6210\u529F"),g.value=e.hash,h.value="success",await O()),S.value=!1}catch(e){S.value=!1,f.value=o("\u6388\u6743\u5931\u8D25"),g.value=o("\u7528\u6237\u53D6\u6D88\u4E86\u6388\u6743"),h.value="error",console.log("\u6388\u6743\u5931\u8D25",e)}_.value=!0},N=u(0),te=async()=>{const e=await Ne(c.address);N.value=Number(e.toString())||0},$=u(0),ae=async()=>{const e=await Ae(c.address);$.value=j(e)||0},D=u({}),B=u(!1),T=u(!1),G=async()=>{await te(),await ae();const e=await Fe();e.box_fragment&&(D.value=e,N.value>e.box_fragment&&(B.value=!0),$.value>j(e.coin_amount)&&(T.value=!0))};Z(async()=>{await G()});const U=u(!1),x=u(!1),oe=async()=>{try{x.value=!0;const e={tokenId:0,userAddress:c.address,orderType:2,coinAmount:String(D.value.coin_amount),goldCoinAmount:String(D.value.goldcoin_amount),boxFragment:String(D.value.box_fragment),starFragment:String(0),targetLevel:0,targetStarRate:0,tokenType:$e.token_diamond,userSign:""},w=ge(),H=await fe(),ie=_e(Number(H)),W=await he(ie,w,e);if(W){e.userSign=W;const z=await Ce(e);if(z.data.signature){let A=await ye(z.data);A.hash&&(f.value=o("\u5408\u6210\u6210\u529F"),g.value=A.hash,h.value="success"),await A.wait(2),A.from&&await G()}}U.value=!0,x.value=!1}catch(e){x.value=!1,f.value=o("\u5408\u6210\u5931\u8D25"),g.value=o("\u7528\u6237\u53D6\u6D88\u4E86\u5408\u6210"),h.value="error",console.log("\u5408\u6210\u76F2\u76D2\u5931\u8D25",e)}_.value=!0},se=()=>{C.push("/user?tab=blingBox")},ue=F(()=>!B.value&&b.value&&v.value),le=F(()=>B.value&&b.value&&v.value&&!T.value),ne=F(()=>B.value&&T.value&&v.value&&b.value&&!x.value),J=F(()=>!v.value&&k.value),R=F(()=>!b.value&&S.value);return(e,w)=>(l(),L(Be,null,[r(be,null,{default:n(()=>[p(s(a(o)("\u5408\u6210\u76F2\u76D2\u63D0\u793A")),1)]),_:1}),t("div",Je,[t("div",Re,[t("div",We,[t("div",null,[r(V,{mark:!1,border:!1,img:`${a(K)}/img/blindbox.png`},null,8,["img"])]),t("div",ze,[t("p",Ke,s(a(o)("\u5408\u6210\u9700\u8981")),1),t("p",Ze,s(D.value.box_fragment)+s(a(o)("\u76F2\u76D2\u788E\u7247")),1)])]),je,t("div",qe,[t("div",null,[r(V,{mark:!1,border:!1,img:`${a(K)}/img/DMT.png`},null,8,["img"])]),t("div",Pe,[t("p",Qe,s(a(o)("\u5408\u6210\u9700\u8981")),1),t("p",Xe,s(a(ke)(D.value.goldcoin_amount))+"DTH",1)])])]),t("div",Ye,[t("div",null,[B.value?i("",!0):(l(),L("div",et,[p(s(a(o)("\u788E\u7247\u4F59\u989D"))+"\uFF1A",1),t("span",tt,s(N.value),1)])),B.value&&!T.value?(l(),L("div",at,[p(s(a(o)("DMT\u4F59\u989D"))+"\uFF1A",1),t("span",ot,s($.value),1)])):i("",!0),t("div",st,[a(ue)?(l(),m(d,{key:0,active:"",currentType:"disabled",class:"disabled-btn"},{default:n(()=>[p(s(a(o)("\u788E\u7247\u4F59\u989D\u4E0D\u8DB3")),1)]),_:1})):i("",!0),a(le)?(l(),m(d,{key:1,active:"",currentType:"disabled",class:"disabled-btn"},{default:n(()=>[p(s(a(o)("DMT\u4F59\u989D\u4E0D\u8DB3")),1)]),_:1})):i("",!0),a(ne)?(l(),m(d,{key:2,onClick:oe},{default:n(()=>[p(s(a(o)("\u5408\u6210\u76F2\u76D2")),1)]),_:1})):i("",!0),x.value?(l(),m(d,{key:3,active:"",class:"disabled-btn",style:{color:"#E1C392"}},{default:n(()=>[t("div",ut,[r(M),t("div",lt,s(a(o)("\u5408\u6210\u4E2D"))+"...",1)])]),_:1})):i("",!0),!v.value&&!a(J)?(l(),m(d,{key:4,onClick:Y},{default:n(()=>[p(s(a(o)("\u6388\u6743\u76F2\u76D2")),1)]),_:1})):i("",!0),a(J)?(l(),m(d,{key:5,style:{cursor:"not-allowed"}},{default:n(()=>[t("div",nt,[r(M),t("div",it,s(a(o)("\u6388\u6743\u4E2D"))+"...",1)])]),_:1})):i("",!0),!b.value&&v.value&&!a(R)?(l(),m(d,{key:6,onClick:ee},{default:n(()=>[p(s(a(o)("\u6388\u6743DTH")),1)]),_:1})):i("",!0),a(R)?(l(),m(d,{key:7,style:{cursor:"not-allowed"}},{default:n(()=>[t("div",rt,[r(M),t("div",ct,s(a(o)("\u6388\u6743\u4E2D"))+"...",1)])]),_:1})):i("",!0)]),t("div",dt,[t("span",null,s(a(o)("\u6CA1\u6709\u788E\u7247"))+"\uFF1F",1),t("span",{class:"base-active-text",style:{"text-decoration":"underline",cursor:"pointer"},onClick:E},s(a(o)("\u53BB\u83B7\u5F97")),1)])])]),r(Oe,{show:U.value,onClose:w[0]||(w[0]=H=>U.value=!1),onNavigateTo:se},null,8,["show"]),r(pe,{title:f.value,desc:g.value,show:_.value,type:h.value,onClose:w[1]||(w[1]=H=>_.value=!1),onDescClick:X},null,8,["title","desc","show","type"])])],64))}});var pa=q(mt,[["__scopeId","data-v-7681bf99"]]);export{pa as default};
