import{g as V,Q as re}from"./getAssetsFile-1cb5fec2.js";import{_ as j,B as d,F as ce,u as de,M as me,J as pe,V as ve,T as ge,U as _e,W as fe,L as M}from"./index-670e8a69.js";import{B as O}from"./Border-60362460.js";import{T as he,b as be}from"./UpgradeNft-c5355e05.js";import{u as q}from"./vue-i18n-5b28fcda.js";/* empty css                                                          */import{a9 as P,az as l,Z as m,b1 as n,a0 as t,a7 as r,D as a,a6 as p,K as o,r as u,w as ye,ap as Q,h as F,$ as L,_ as i,O as De,aC as Be,aA as xe}from"./@vue-823c75d3.js";import{h as we,l as Fe}from"./index-67d997ef.js";import{a as Z,b as Ce}from"./format-7642b802.js";import{b as ke,a as Se,g as Te}from"./GoldCoin-34537be7.js";import{f as Ae,b as Ee,g as Ie}from"./Fragment-a6eae01f.js";import{t as Ne}from"./index-6e37b267.js";import{u as $e}from"./vue-router-4d4637a0.js";import"./pinia-d7eeac71.js";import"./vue-demi-5b9a0fa5.js";import"./@metamask-0322580d.js";import"./@ethersproject-baa9d35e.js";import"./js-sha3-24137471.js";import"./hash.js-a20011ef.js";import"./minimalistic-assert-c1ce1705.js";import"./inherits-1fe83bc7.js";import"./bech32-9a81277b.js";import"./@walletconnect-6b5bf47d.js";import"./is-typedarray-4f40b03b.js";import"./query-string-2015e57d.js";import"./strict-uri-encode-ecbf5106.js";import"./decode-uri-component-fb3850ff.js";import"./split-on-first-6a113853.js";import"./typedarray-to-buffer-3049f596.js";import"./detect-browser-d6d27bfa.js";import"./qrcode-8475bf43.js";import"./isarray-dd297434.js";import"./buffer-42a74e2f.js";import"./base64-js-f5f6d31b.js";import"./ieee754-b34e253f.js";import"./dijkstrajs-5cebdf0c.js";import"./copy-to-clipboard-792b0d71.js";import"./toggle-selection-eefc0dc5.js";import"./preact-c6b9a0a0.js";import"./process-79043346.js";import"./@intlify-22bbbbdc.js";import"./vue-b8cbd5d3.js";/* empty css                                                         */import"./public-d3b40f67.js";import"./qs-899482d5.js";import"./side-channel-c89d4eb5.js";import"./get-intrinsic-13ed3457.js";import"./has-symbols-39607a5b.js";import"./function-bind-f4350d04.js";import"./has-c67be6c1.js";import"./call-bind-60ebbe96.js";import"./object-inspect-cc1301a1.js";import"./dayjs-3b7406d5.js";import"./axios-f45f83e3.js";const Ue={class:"content"},He={class:"card"},Me={class:"handler"},Le=P({__name:"SuccessDialog",props:{show:{type:Boolean,default:!1}},emits:["close","navigateTo"],setup(y,{emit:s}){const{t:c}=q(),C=()=>{s("close")},E=()=>{s("navigateTo")};return(v,I)=>(l(),m(ce,{show:y.show,onClose:C,title:a(c)("\u606D\u559C\u83B7\u5F97\u76F2\u76D2")},{default:n(()=>[t("div",Ue,[t("div",He,[r(O,{mark:!1,border:!1,img:a(V)("global/blindBxo.gif")},null,8,["img"])]),t("div",Me,[r(d,{onClick:E},{default:n(()=>[p(o(a(c)("\u5F00\u542F\u76F2\u76D2")),1)]),_:1}),t("div",{class:"tips",onClick:C},o(a(c)("\u6211\u77E5\u9053\u4E86")),1)])])]),_:1},8,["show","title"]))}});var Ve=j(Le,[["__scopeId","data-v-28cf51da"]]);const Oe=y=>(Be("data-v-4a1a1b7c"),y=y(),xe(),y),Ge={class:"blind-box"},Je={class:"top-block"},Re={class:"base-box"},We={class:"info"},ze={class:"need"},Ke={class:"value"},Qe=Oe(()=>t("div",{class:"item-center"},[t("div",{class:"and-pic"},[t("img",{src:re})])],-1)),Ze={class:"base-box"},je={class:"info"},qe={class:"need"},Pe={class:"value"},Xe={class:"bottom-block"},Ye={key:0,class:"base-tips",style:{color:"rgba(230, 241, 255, 0.6500)"}},et={class:"base-active-text"},tt={key:1,class:"base-tips",style:{color:"rgba(230, 241, 255, 0.6500)"}},at={class:"base-active-text"},ot={class:"btn-block"},st={class:"flex"},ut={class:"composeing"},lt={style:{display:"flex","align-items":"center"}},nt={style:{"margin-left":"5px"}},it={style:{display:"flex","align-items":"center"}},rt={style:{"margin-left":"5px"}},ct={class:"base-tips"},dt=P({__name:"Index",setup(y){const{t:s}=q(),c=de(),C=$e(),E=()=>{window.open("")},v=u(!1),I=async()=>{try{const e=await Ae(c.address);v.value=e}catch(e){console.log("\u672A\u77E5\u9519\u8BEF",e)}},_=u(""),g=u(""),f=u(!1),h=u("success"),X=()=>{window.open(`${pe}${g.value}`)};ye(f,e=>{setTimeout(()=>{e&&(f.value=!1)},3e3)});const k=u(!1),Y=async()=>{try{k.value=!0;const e=await Ee();e.from&&(await e.wait(2),await I(),_.value="\u6388\u6743\u6210\u529F",g.value=e.hash,h.value="success"),k.value=!1}catch(e){k.value=!1,_.value="\u6388\u6743\u5931\u8D25",g.value="\u7528\u6237\u53D6\u6D88\u4E86\u6388\u6743",h.value="error",console.log("\u6388\u6743\u76F2\u76D2\u5931\u8D25",e)}f.value=!0};Q(()=>{I(),G()});const b=u(!1),G=async()=>{try{const e=await ke(c.address);Number(e.toString())>0?b.value=!0:b.value=!1}catch(e){console.log("\u672A\u77E5\u9519\u8BEF",e)}},S=u(!1),ee=async()=>{try{S.value=!0;const e=await Se();e.from&&(await e.wait(2),_.value="\u6388\u6743\u6210\u529F",g.value=e.hash,h.value="success",await G()),S.value=!1}catch(e){S.value=!1,_.value="\u6388\u6743\u5931\u8D25",g.value="\u7528\u6237\u53D6\u6D88\u4E86\u6388\u6743",h.value="error",console.log("\u6388\u6743\u5931\u8D25",e)}f.value=!0},N=u(0),te=async()=>{const e=await Ie(c.address);N.value=Number(e.toString())||0},$=u(0),ae=async()=>{const e=await Te(c.address);$.value=Z(e)||0},D=u({}),B=u(!1),T=u(!1),J=async()=>{await te(),await ae();const e=await we();e.box_fragment&&(D.value=e,N.value>e.box_fragment&&(B.value=!0),$.value>Z(e.coin_amount)&&(T.value=!0))};Q(async()=>{await J()});const U=u(!1),w=u(!1),oe=async()=>{try{w.value=!0;const e={tokenId:0,userAddress:c.address,orderType:2,coinAmount:String(D.value.coin_amount),goldCoinAmount:String(D.value.goldcoin_amount),boxFragment:String(D.value.box_fragment),starFragment:String(0),targetLevel:0,targetStarRate:0,tokenType:Ne.token_diamond,userSign:""},x=ve(),H=await ge(),ie=_e(Number(H)),z=await fe(ie,x,e);if(z){e.userSign=z;const K=await Fe(e);if(K.data.signature){let A=await be(K.data);A.hash&&(_.value="\u5408\u6210\u6210\u529F",g.value=A.hash,h.value="success"),await A.wait(2),A.from&&await J()}}U.value=!0,w.value=!1}catch(e){w.value=!1,_.value="\u5408\u6210\u5931\u8D25",g.value="\u7528\u6237\u53D6\u6D88\u4E86\u6216\u65AD\u5F00\u4E86\u5408\u6210",h.value="error",console.log("\u5408\u6210\u76F2\u76D2\u5931\u8D25",e)}f.value=!0},se=()=>{C.push("/user?tab=blingBox")},ue=F(()=>!B.value&&b.value&&v.value),le=F(()=>B.value&&b.value&&v.value&&!T.value),ne=F(()=>B.value&&T.value&&v.value&&b.value&&!w.value),R=F(()=>!v.value&&k.value),W=F(()=>!b.value&&S.value);return(e,x)=>(l(),L(De,null,[r(he,null,{default:n(()=>[p(o(a(s)("\u5408\u6210\u76F2\u76D2\u63D0\u793A")),1)]),_:1}),t("div",Ge,[t("div",Je,[t("div",Re,[t("div",null,[r(O,{mark:!1,border:!1,img:a(V)("pc/blindBox/blindbox.png")},null,8,["img"])]),t("div",We,[t("p",ze,o(a(s)("\u5408\u6210\u9700\u8981")),1),t("p",Ke,o(D.value.box_fragment)+o(a(s)("\u76F2\u76D2\u788E\u7247")),1)])]),Qe,t("div",Ze,[t("div",null,[r(O,{mark:!1,border:!1,img:a(V)("pc/blindBox/DMT.png")},null,8,["img"])]),t("div",je,[t("p",qe,o(a(s)("\u5408\u6210\u9700\u8981")),1),t("p",Pe,o(a(Ce)(D.value.goldcoin_amount))+"DTH",1)])])]),t("div",Xe,[t("div",null,[B.value?i("",!0):(l(),L("div",Ye,[p(o(a(s)("\u788E\u7247\u4F59\u989D"))+"\uFF1A",1),t("span",et,o(N.value),1)])),B.value&&!T.value?(l(),L("div",tt,[p(o(a(s)("DMT\u4F59\u989D"))+"\uFF1A",1),t("span",at,o($.value),1)])):i("",!0),t("div",ot,[a(ue)?(l(),m(d,{key:0,active:"",currentType:"disabled",class:"disabled-btn"},{default:n(()=>[p(o(a(s)("\u788E\u7247\u4F59\u989D\u4E0D\u8DB3")),1)]),_:1})):i("",!0),a(le)?(l(),m(d,{key:1,active:"",currentType:"disabled",class:"disabled-btn"},{default:n(()=>[p(o(a(s)("DMT\u4F59\u989D\u4E0D\u8DB3")),1)]),_:1})):i("",!0),a(ne)?(l(),m(d,{key:2,onClick:oe},{default:n(()=>[p(o(a(s)("\u5408\u6210\u76F2\u76D2")),1)]),_:1})):i("",!0),w.value?(l(),m(d,{key:3,active:"",class:"disabled-btn",style:{color:"#E1C392"}},{default:n(()=>[t("div",st,[r(M),t("div",ut,o(a(s)("\u5408\u6210\u4E2D"))+"...",1)])]),_:1})):i("",!0),!v.value&&!a(R)?(l(),m(d,{key:4,onClick:Y},{default:n(()=>[p(o(a(s)("\u6388\u6743\u76F2\u76D2")),1)]),_:1})):i("",!0),a(R)?(l(),m(d,{key:5,style:{cursor:"not-allowed"}},{default:n(()=>[t("div",lt,[r(M),t("div",nt,o(a(s)("\u6388\u6743\u4E2D"))+"...",1)])]),_:1})):i("",!0),!b.value&&v.value&&!a(W)?(l(),m(d,{key:6,onClick:ee},{default:n(()=>[p(o(a(s)("\u6388\u6743DTH")),1)]),_:1})):i("",!0),a(W)?(l(),m(d,{key:7,style:{cursor:"not-allowed"}},{default:n(()=>[t("div",it,[r(M),t("div",rt,o(a(s)("\u6388\u6743\u4E2D"))+"...",1)])]),_:1})):i("",!0)]),t("div",ct,[t("span",null,o(a(s)("\u6CA1\u6709\u788E\u7247"))+"\uFF1F",1),t("span",{class:"base-active-text",style:{"text-decoration":"underline",cursor:"pointer"},onClick:E},o(a(s)("\u53BB\u83B7\u5F97")),1)])])]),r(Ve,{show:U.value,onClose:x[0]||(x[0]=H=>U.value=!1),onNavigateTo:se},null,8,["show"]),r(me,{title:_.value,desc:g.value,show:f.value,type:h.value,onClose:x[1]||(x[1]=H=>f.value=!1),onDescClick:X},null,8,["title","desc","show","type"])])],64))}});var ma=j(dt,[["__scopeId","data-v-4a1a1b7c"]]);export{ma as default};
