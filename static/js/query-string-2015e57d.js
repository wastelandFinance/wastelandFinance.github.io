import{s as $}from"./strict-uri-encode-ecbf5106.js";import{d as U}from"./decode-uri-component-fb3850ff.js";import{s as q}from"./split-on-first-6a113853.js";var w={};(function(d){const j=$,h=U,u=q,O=r=>r==null;function S(r){switch(r.arrayFormat){case"index":return e=>(n,t)=>{const a=n.length;return t===void 0||r.skipNull&&t===null||r.skipEmptyString&&t===""?n:t===null?[...n,[s(e,r),"[",a,"]"].join("")]:[...n,[s(e,r),"[",s(a,r),"]=",s(t,r)].join("")]};case"bracket":return e=>(n,t)=>t===void 0||r.skipNull&&t===null||r.skipEmptyString&&t===""?n:t===null?[...n,[s(e,r),"[]"].join("")]:[...n,[s(e,r),"[]=",s(t,r)].join("")];case"comma":case"separator":return e=>(n,t)=>t==null||t.length===0?n:n.length===0?[[s(e,r),"=",s(t,r)].join("")]:[[n,s(t,r)].join(r.arrayFormatSeparator)];default:return e=>(n,t)=>t===void 0||r.skipNull&&t===null||r.skipEmptyString&&t===""?n:t===null?[...n,s(e,r)]:[...n,[s(e,r),"=",s(t,r)].join("")]}}function N(r){let e;switch(r.arrayFormat){case"index":return(n,t,a)=>{if(e=/\[(\d*)\]$/.exec(n),n=n.replace(/\[\d*\]$/,""),!e){a[n]=t;return}a[n]===void 0&&(a[n]={}),a[n][e[1]]=t};case"bracket":return(n,t,a)=>{if(e=/(\[\])$/.exec(n),n=n.replace(/\[\]$/,""),!e){a[n]=t;return}if(a[n]===void 0){a[n]=[t];return}a[n]=[].concat(a[n],t)};case"comma":case"separator":return(n,t,a)=>{const f=typeof t=="string"&&t.split("").indexOf(r.arrayFormatSeparator)>-1?t.split(r.arrayFormatSeparator).map(i=>m(i,r)):t===null?t:m(t,r);a[n]=f};default:return(n,t,a)=>{if(a[n]===void 0){a[n]=t;return}a[n]=[].concat(a[n],t)}}}function l(r){if(typeof r!="string"||r.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function s(r,e){return e.encode?e.strict?j(r):encodeURIComponent(r):r}function m(r,e){return e.decode?h(r):r}function y(r){return Array.isArray(r)?r.sort():typeof r=="object"?y(Object.keys(r)).sort((e,n)=>Number(e)-Number(n)).map(e=>r[e]):r}function o(r){const e=r.indexOf("#");return e!==-1&&(r=r.slice(0,e)),r}function A(r){let e="";const n=r.indexOf("#");return n!==-1&&(e=r.slice(n)),e}function g(r){r=o(r);const e=r.indexOf("?");return e===-1?"":r.slice(e+1)}function b(r,e){return e.parseNumbers&&!Number.isNaN(Number(r))&&typeof r=="string"&&r.trim()!==""?r=Number(r):e.parseBooleans&&r!==null&&(r.toLowerCase()==="true"||r.toLowerCase()==="false")&&(r=r.toLowerCase()==="true"),r}function F(r,e){e=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},e),l(e.arrayFormatSeparator);const n=N(e),t=Object.create(null);if(typeof r!="string"||(r=r.trim().replace(/^[?#&]/,""),!r))return t;for(const a of r.split("&")){let[c,f]=u(e.decode?a.replace(/\+/g," "):a,"=");f=f===void 0?null:["comma","separator"].includes(e.arrayFormat)?f:m(f,e),n(m(c,e),f,t)}for(const a of Object.keys(t)){const c=t[a];if(typeof c=="object"&&c!==null)for(const f of Object.keys(c))c[f]=b(c[f],e);else t[a]=b(c,e)}return e.sort===!1?t:(e.sort===!0?Object.keys(t).sort():Object.keys(t).sort(e.sort)).reduce((a,c)=>{const f=t[c];return Boolean(f)&&typeof f=="object"&&!Array.isArray(f)?a[c]=y(f):a[c]=f,a},Object.create(null))}d.extract=g,d.parse=F,d.stringify=(r,e)=>{if(!r)return"";e=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},e),l(e.arrayFormatSeparator);const n=f=>e.skipNull&&O(r[f])||e.skipEmptyString&&r[f]==="",t=S(e),a={};for(const f of Object.keys(r))n(f)||(a[f]=r[f]);const c=Object.keys(a);return e.sort!==!1&&c.sort(e.sort),c.map(f=>{const i=r[f];return i===void 0?"":i===null?s(f,e):Array.isArray(i)?i.reduce(t(f),[]).join("&"):s(f,e)+"="+s(i,e)}).filter(f=>f.length>0).join("&")},d.parseUrl=(r,e)=>{e=Object.assign({decode:!0},e);const[n,t]=u(r,"#");return Object.assign({url:n.split("?")[0]||"",query:F(g(r),e)},e&&e.parseFragmentIdentifier&&t?{fragmentIdentifier:m(t,e)}:{})},d.stringifyUrl=(r,e)=>{e=Object.assign({encode:!0,strict:!0},e);const n=o(r.url).split("?")[0]||"",t=d.extract(r.url),a=d.parse(t,{sort:!1}),c=Object.assign(a,r.query);let f=d.stringify(c,e);f&&(f=`?${f}`);let i=A(r.url);return r.fragmentIdentifier&&(i=`#${s(r.fragmentIdentifier,e)}`),`${n}${f}${i}`}})(w);export{w as q};
