import{g as A,Z as at}from"./getAssetsFile-12900b89.js";import{B as I}from"./Border-47a72e5b.js";import{_ as z,B as c,D as st,u as ut,R as nt,P as it,Q as rt,S as lt,L as T}from"./index-21fc6ed5.js";import{T as ct,b as dt}from"./UpgradeNft-19f40d0f.js";import{u as J}from"./vue-i18n-5b28fcda.js";/* empty css                                                          */import{a9 as K,az as i,Z as d,b1 as n,a0 as t,a7 as m,D as e,a6 as p,K as a,r as u,ap as G,h,$ as mt,_ as l,O as pt,aC as gt,aA as _t}from"./@vue-823c75d3.js";import{h as vt,l as ft}from"./index-8162cc3d.js";import{a as Z,b as bt}from"./format-7642b802.js";import{b as ht,a as Bt,g as Ft}from"./GoldCoin-6f3150fa.js";import{f as yt,b as xt,g as Dt}from"./Fragment-e4e04308.js";import{t as Ct}from"./index-e0361287.js";import{u as wt}from"./vue-router-4d4637a0.js";import"./pinia-d7eeac71.js";import"./vue-demi-5b9a0fa5.js";import"./@metamask-0322580d.js";import"./@ethersproject-baa9d35e.js";import"./js-sha3-24137471.js";import"./hash.js-a20011ef.js";import"./minimalistic-assert-c1ce1705.js";import"./inherits-1fe83bc7.js";import"./bech32-9a81277b.js";import"./@walletconnect-6b5bf47d.js";import"./is-typedarray-4f40b03b.js";import"./query-string-2015e57d.js";import"./strict-uri-encode-ecbf5106.js";import"./decode-uri-component-fb3850ff.js";import"./split-on-first-6a113853.js";import"./typedarray-to-buffer-3049f596.js";import"./detect-browser-d6d27bfa.js";import"./qrcode-8475bf43.js";import"./isarray-dd297434.js";import"./buffer-42a74e2f.js";import"./base64-js-f5f6d31b.js";import"./ieee754-b34e253f.js";import"./dijkstrajs-5cebdf0c.js";import"./copy-to-clipboard-792b0d71.js";import"./toggle-selection-eefc0dc5.js";import"./preact-c6b9a0a0.js";import"./process-79043346.js";import"./@intlify-22bbbbdc.js";import"./vue-b8cbd5d3.js";/* empty css                                                         */import"./public-d126e26e.js";import"./qs-899482d5.js";import"./side-channel-c89d4eb5.js";import"./get-intrinsic-13ed3457.js";import"./has-symbols-39607a5b.js";import"./function-bind-f4350d04.js";import"./has-c67be6c1.js";import"./call-bind-60ebbe96.js";import"./object-inspect-cc1301a1.js";import"./dayjs-3b7406d5.js";import"./axios-f45f83e3.js";const St={class:"content"},kt={class:"card"},Et={class:"handler"},Tt=K({__name:"SuccessDialog",props:{show:{type:Boolean,default:!1}},emits:["close","navigateTo"],setup(v,{emit:s}){const{t:r}=J(),B=()=>{s("close")},C=()=>{s("navigateTo")};return(g,w)=>(i(),d(st,{show:v.show,onClose:B,title:e(r)("\u606D\u559C\u83B7\u5F97\u76F2\u76D2")},{default:n(()=>[t("div",St,[t("div",kt,[m(I,{mark:!1,border:!1,img:e(A)("global/blindBxo.gif")},null,8,["img"])]),t("div",Et,[m(c,{onClick:C},{default:n(()=>[p(a(e(r)("\u5F00\u542F\u76F2\u76D2")),1)]),_:1}),t("div",{class:"tips",onClick:B},a(e(r)("\u6211\u77E5\u9053\u4E86")),1)])])]),_:1},8,["show","title"]))}});var At=z(Tt,[["__scopeId","data-v-28cf51da"]]);const It=v=>(gt("data-v-7c241bdc"),v=v(),_t(),v),Nt=p(" \u901A\u8FC7\u6253\u6E38\u620F\u526F\u672C\uFF0C\u6709\u51E0\u7387\u83B7\u5F97\u76F2\u76D2\u788E\u7247\uFF0C\u4F60\u9700\u8981\u5C06\u6E38\u620F\u5185\u76F2\u76D2\u788E\u7247\u63D0\u53D6\u5230\u94B1\u5305\uFF0C\u624D\u53EF\u4EE5\u5C06\u788E\u7247\u5408\u6210\u4E3A\u76F2\u76D2 "),Ut={class:"blind-box"},Ht={class:"top-block"},$t={class:"base-box"},Lt={class:"info"},Ot={class:"need"},Vt={class:"value"},Mt=It(()=>t("div",{class:"item-center"},[t("div",{class:"and-pic"},[t("img",{src:at})])],-1)),Rt={class:"base-box"},Gt={class:"info"},Zt={class:"need"},zt={class:"value"},Jt={class:"bottom-block"},Kt={class:"base-tips",style:{color:"rgba(230, 241, 255, 0.6500)"}},Pt={class:"base-active-text"},Qt={class:"btn-block"},Wt={class:"flex"},jt={class:"composeing"},qt={style:{display:"flex","align-items":"center"}},Xt={style:{"margin-left":"5px"}},Yt={style:{display:"flex","align-items":"center"}},te={style:{"margin-left":"5px"}},ee={class:"base-tips"},oe=K({__name:"Index",setup(v){const{t:s}=J(),r=ut(),B=wt(),C=()=>{window.open("")},g=u(!1),w=async()=>{const o=await yt(r.address);g.value=o},F=u(!1),P=async()=>{try{F.value=!0,(await xt()).from&&w(),F.value=!1}catch(o){F.value=!1,console.log("\u6388\u6743\u76F2\u76D2\u5931\u8D25",o)}};G(async()=>{await w(),await N()});const _=u(!1),N=async()=>{const o=await ht(r.address);Number(o.toString())>0?_.value=!0:_.value=!1},y=u(!1),Q=async()=>{try{y.value=!0,(await Bt()).from&&N(),y.value=!1}catch(o){y.value=!1,console.log("\u6388\u6743\u5931\u8D25",o)}},S=u(0),W=async()=>{const o=await Dt(r.address);S.value=Number(o.toString())||0},U=u(0),j=async()=>{const o=await Ft(r.address);U.value=Z(o)||0},f=u({}),x=u(!1),k=u(!1),H=async()=>{await W(),await j();const o=await vt();o.box_fragment&&(f.value=o,S.value>o.box_fragment&&(x.value=!0),U.value>Z(o.coin_amount)&&(k.value=!0))};G(async()=>{await H()});const E=u(!1),b=u(!1),q=async()=>{try{b.value=!0;const o={tokenId:0,userAddress:r.address,orderType:2,coinAmount:String(f.value.coin_amount),goldCoinAmount:String(f.value.goldcoin_amount),boxFragment:String(f.value.box_fragment),starFragment:String(0),targetLevel:0,targetStarRate:0,tokenType:Ct.token_diamond,userSign:""},D=nt(),O=await it(),ot=rt(Number(O)),V=await lt(ot,D,o);if(V){o.userSign=V;const M=await ft(o);if(M.data.signature){let R=await dt(M.data);await R.wait(1),R.from&&await H()}}E.value=!0,b.value=!1}catch(o){b.value=!1,console.log("\u5408\u6210\u76F2\u76D2\u5931\u8D25",o)}},X=()=>{B.push("/user?tab=blingBox")},Y=h(()=>!x.value&&_.value&&g.value),tt=h(()=>x.value&&_.value&&g.value&&!k.value),et=h(()=>x.value&&k.value&&g.value&&_.value&&!b.value),$=h(()=>!g.value&&F.value),L=h(()=>!_.value&&y.value);return(o,D)=>(i(),mt(pt,null,[m(ct,null,{default:n(()=>[Nt]),_:1}),t("div",Ut,[t("div",Ht,[t("div",$t,[t("div",null,[m(I,{mark:!1,border:!1,img:e(A)("pc/blindBox/blindbox.png")},null,8,["img"])]),t("div",Lt,[t("p",Ot,a(e(s)("\u5408\u6210\u9700\u8981")),1),t("p",Vt,a(f.value.box_fragment)+a(e(s)("\u76F2\u76D2\u788E\u7247")),1)])]),Mt,t("div",Rt,[t("div",null,[m(I,{mark:!1,border:!1,img:e(A)("pc/blindBox/DMT.png")},null,8,["img"])]),t("div",Gt,[t("p",Zt,a(e(s)("\u5408\u6210\u9700\u8981")),1),t("p",zt,a(e(bt)(f.value.goldcoin_amount))+"DTH",1)])])]),t("div",Jt,[t("div",null,[t("div",Kt,[p(a(e(s)("\u788E\u7247\u4F59\u989D"))+"\uFF1A",1),t("span",Pt,a(S.value),1)]),l("",!0),t("div",Qt,[e(Y)?(i(),d(c,{key:0,active:"",currentType:"disabled",class:"disabled-btn"},{default:n(()=>[p(a(e(s)("\u788E\u7247\u4F59\u989D\u4E0D\u8DB3")),1)]),_:1})):l("",!0),e(tt)?(i(),d(c,{key:1,active:"",currentType:"disabled",class:"disabled-btn"},{default:n(()=>[p(a(e(s)("DMT\u4F59\u989D\u4E0D\u8DB3")),1)]),_:1})):l("",!0),e(et)?(i(),d(c,{key:2,onClick:q},{default:n(()=>[p(a(e(s)("\u5408\u6210\u76F2\u76D2")),1)]),_:1})):l("",!0),b.value?(i(),d(c,{key:3,active:"",class:"disabled-btn",style:{color:"#E1C392"}},{default:n(()=>[t("div",Wt,[m(T),t("div",jt,a(e(s)("\u5408\u6210\u4E2D"))+"...",1)])]),_:1})):l("",!0),!g.value&&!e($)?(i(),d(c,{key:4,onClick:P},{default:n(()=>[p(a(e(s)("\u6388\u6743\u76F2\u76D2")),1)]),_:1})):l("",!0),e($)?(i(),d(c,{key:5,style:{cursor:"not-allowed"}},{default:n(()=>[t("div",qt,[m(T),t("div",Xt,a(e(s)("\u6388\u6743\u4E2D"))+"...",1)])]),_:1})):l("",!0),!_.value&&g.value&&!e(L)?(i(),d(c,{key:6,onClick:Q},{default:n(()=>[p(a(e(s)("\u6388\u6743DTH")),1)]),_:1})):l("",!0),e(L)?(i(),d(c,{key:7,style:{cursor:"not-allowed"}},{default:n(()=>[t("div",Yt,[m(T),t("div",te,a(e(s)("\u6388\u6743\u4E2D"))+"...",1)])]),_:1})):l("",!0)]),t("div",ee,[p(a(e(s)("\u6CA1\u6709\u788E\u7247"))+"\uFF1F",1),t("span",{class:"base-active-text",style:{"text-decoration":"underline",cursor:"pointer"},onClick:C},a(e(s)("\u53BB\u83B7\u5F97")),1)])])]),m(At,{show:E.value,onClose:D[0]||(D[0]=O=>E.value=!1),onNavigateTo:X},null,8,["show"])])],64))}});var ao=z(oe,[["__scopeId","data-v-7c241bdc"]]);export{ao as default};
