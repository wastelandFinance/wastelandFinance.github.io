import{g as V,$ as re}from"./getAssetsFile-cd9e36ca.js";import{_ as q,B as d,E as ce,u as de,M as me,I as pe,U as ve,S as ge,T as _e,V as fe,L as M}from"./index-0faa561c.js";import{B as O}from"./Border-0b13b5cb.js";import{T as he,b as be}from"./UpgradeNft-412aaf8e.js";import{u as P}from"./vue-i18n-5b28fcda.js";/* empty css                                                          */import{a9 as Q,az as l,Z as m,b1 as n,a0 as e,a7 as r,D as a,a6 as p,K as s,r as u,w as ye,ap as Z,h as F,$ as L,_ as i,O as De,aC as xe,aA as Be}from"./@vue-823c75d3.js";import{h as we,l as Fe}from"./index-7ffaa781.js";import{a as j,b as Ce}from"./format-7642b802.js";import{b as ke,a as Se,g as Te}from"./GoldCoin-a6c3c42d.js";import{f as Ae,b as Ee,g as Ie}from"./Fragment-bdab6ad8.js";import{t as Ne}from"./index-bb241e93.js";import{u as $e}from"./vue-router-4d4637a0.js";import"./pinia-d7eeac71.js";import"./vue-demi-5b9a0fa5.js";import"./@metamask-0322580d.js";import"./@ethersproject-baa9d35e.js";import"./js-sha3-24137471.js";import"./hash.js-a20011ef.js";import"./minimalistic-assert-c1ce1705.js";import"./inherits-1fe83bc7.js";import"./bech32-9a81277b.js";import"./@walletconnect-6b5bf47d.js";import"./is-typedarray-4f40b03b.js";import"./query-string-2015e57d.js";import"./strict-uri-encode-ecbf5106.js";import"./decode-uri-component-fb3850ff.js";import"./split-on-first-6a113853.js";import"./typedarray-to-buffer-3049f596.js";import"./detect-browser-d6d27bfa.js";import"./qrcode-8475bf43.js";import"./isarray-dd297434.js";import"./buffer-42a74e2f.js";import"./base64-js-f5f6d31b.js";import"./ieee754-b34e253f.js";import"./dijkstrajs-5cebdf0c.js";import"./copy-to-clipboard-792b0d71.js";import"./toggle-selection-eefc0dc5.js";import"./preact-c6b9a0a0.js";import"./process-79043346.js";import"./@intlify-22bbbbdc.js";import"./vue-b8cbd5d3.js";/* empty css                                                         */import"./public-fdb8458e.js";import"./qs-899482d5.js";import"./side-channel-c89d4eb5.js";import"./get-intrinsic-13ed3457.js";import"./has-symbols-39607a5b.js";import"./function-bind-f4350d04.js";import"./has-c67be6c1.js";import"./call-bind-60ebbe96.js";import"./object-inspect-cc1301a1.js";import"./dayjs-3b7406d5.js";import"./axios-f45f83e3.js";const Ue={class:"content"},He={class:"card"},Me={class:"handler"},Le=Q({__name:"SuccessDialog",props:{show:{type:Boolean,default:!1}},emits:["close","navigateTo"],setup(y,{emit:o}){const{t:c}=P(),C=()=>{o("close")},E=()=>{o("navigateTo")};return(v,I)=>(l(),m(ce,{show:y.show,onClose:C,title:a(c)("\u606D\u559C\u83B7\u5F97\u76F2\u76D2")},{default:n(()=>[e("div",Ue,[e("div",He,[r(O,{mark:!1,border:!1,img:a(V)("global/blindBxo.gif")},null,8,["img"])]),e("div",Me,[r(d,{onClick:E},{default:n(()=>[p(s(a(c)("\u5F00\u542F\u76F2\u76D2")),1)]),_:1}),e("div",{class:"tips",onClick:C},s(a(c)("\u6211\u77E5\u9053\u4E86")),1)])])]),_:1},8,["show","title"]))}});var Ve=q(Le,[["__scopeId","data-v-28cf51da"]]);const Oe=y=>(xe("data-v-404e990a"),y=y(),Be(),y),Ge={class:"blind-box"},Re={class:"top-block"},ze={class:"base-box"},Je={class:"info"},Ke={class:"need"},We={class:"value"},Ze=Oe(()=>e("div",{class:"item-center"},[e("div",{class:"and-pic"},[e("img",{src:re})])],-1)),je={class:"base-box"},qe={class:"info"},Pe={class:"need"},Qe={class:"value"},Xe={class:"bottom-block"},Ye={key:0,class:"base-tips",style:{color:"rgba(230, 241, 255, 0.6500)"}},et={class:"base-active-text"},tt={key:1,class:"base-tips",style:{color:"rgba(230, 241, 255, 0.6500)"}},at={class:"base-active-text"},st={class:"btn-block"},ot={class:"flex"},ut={class:"composeing"},lt={style:{display:"flex","align-items":"center"}},nt={style:{"margin-left":"5px"}},it={style:{display:"flex","align-items":"center"}},rt={style:{"margin-left":"5px"}},ct={class:"base-tips"},dt=Q({__name:"Index",setup(y){const{t:o}=P(),c=de(),C=$e(),E=()=>{window.open("")},v=u(!1),I=async()=>{const t=await Ae(c.address);v.value=t},_=u(""),g=u(""),f=u(!1),h=u("success"),X=()=>{window.open(`${pe}${g.value}`)};ye(f,t=>{setTimeout(()=>{t&&(f.value=!1)},3e3)});const k=u(!1),Y=async()=>{try{k.value=!0;const t=await Ee();t.from&&(_.value="\u6388\u6743\u6210\u529F",g.value=t.hash,h.value="success",I()),k.value=!1}catch(t){k.value=!1,_.value="\u6388\u6743\u5931\u8D25",g.value="\u7528\u6237\u53D6\u6D88\u4E86\u6388\u6743",h.value="error",console.log("\u6388\u6743\u76F2\u76D2\u5931\u8D25",t)}f.value=!0};Z(async()=>{await I(),await G()});const b=u(!1),G=async()=>{const t=await ke(c.address);Number(t.toString())>0?b.value=!0:b.value=!1},S=u(!1),ee=async()=>{try{S.value=!0;const t=await Se();t.from&&(_.value="\u6388\u6743\u6210\u529F",g.value=t.hash,h.value="success",G()),S.value=!1}catch(t){S.value=!1,_.value="\u6388\u6743\u5931\u8D25",g.value="\u7528\u6237\u53D6\u6D88\u4E86\u6388\u6743",h.value="error",console.log("\u6388\u6743\u5931\u8D25",t)}f.value=!0},N=u(0),te=async()=>{const t=await Ie(c.address);N.value=Number(t.toString())||0},$=u(0),ae=async()=>{const t=await Te(c.address);$.value=j(t)||0},D=u({}),x=u(!1),T=u(!1),R=async()=>{await te(),await ae();const t=await we();t.box_fragment&&(D.value=t,N.value>t.box_fragment&&(x.value=!0),$.value>j(t.coin_amount)&&(T.value=!0))};Z(async()=>{await R()});const U=u(!1),w=u(!1),se=async()=>{try{w.value=!0;const t={tokenId:0,userAddress:c.address,orderType:2,coinAmount:String(D.value.coin_amount),goldCoinAmount:String(D.value.goldcoin_amount),boxFragment:String(D.value.box_fragment),starFragment:String(0),targetLevel:0,targetStarRate:0,tokenType:Ne.token_diamond,userSign:""},B=ve(),H=await ge(),ie=_e(Number(H)),K=await fe(ie,B,t);if(K){t.userSign=K;const W=await Fe(t);if(W.data.signature){let A=await be(W.data);A.hash&&(_.value="\u5408\u6210\u6210\u529F",g.value=A.hash,h.value="success"),await A.wait(1),A.from&&await R()}}U.value=!0,w.value=!1}catch(t){w.value=!1,_.value="\u5408\u6210\u5931\u8D25",g.value="\u7528\u6237\u53D6\u6D88\u4E86\u6216\u65AD\u5F00\u4E86\u5408\u6210",h.value="error",console.log("\u5408\u6210\u76F2\u76D2\u5931\u8D25",t)}f.value=!0},oe=()=>{C.push("/user?tab=blingBox")},ue=F(()=>!x.value&&b.value&&v.value),le=F(()=>x.value&&b.value&&v.value&&!T.value),ne=F(()=>x.value&&T.value&&v.value&&b.value&&!w.value),z=F(()=>!v.value&&k.value),J=F(()=>!b.value&&S.value);return(t,B)=>(l(),L(De,null,[r(he,null,{default:n(()=>[p(s(a(o)("\u5408\u6210\u76F2\u76D2\u63D0\u793A")),1)]),_:1}),e("div",Ge,[e("div",Re,[e("div",ze,[e("div",null,[r(O,{mark:!1,border:!1,img:a(V)("pc/blindBox/blindbox.png")},null,8,["img"])]),e("div",Je,[e("p",Ke,s(a(o)("\u5408\u6210\u9700\u8981")),1),e("p",We,s(D.value.box_fragment)+s(a(o)("\u76F2\u76D2\u788E\u7247")),1)])]),Ze,e("div",je,[e("div",null,[r(O,{mark:!1,border:!1,img:a(V)("pc/blindBox/DMT.png")},null,8,["img"])]),e("div",qe,[e("p",Pe,s(a(o)("\u5408\u6210\u9700\u8981")),1),e("p",Qe,s(a(Ce)(D.value.goldcoin_amount))+"DTH",1)])])]),e("div",Xe,[e("div",null,[x.value?i("",!0):(l(),L("div",Ye,[p(s(a(o)("\u788E\u7247\u4F59\u989D"))+"\uFF1A",1),e("span",et,s(N.value),1)])),x.value&&!T.value?(l(),L("div",tt,[p(s(a(o)("DMT\u4F59\u989D"))+"\uFF1A",1),e("span",at,s($.value),1)])):i("",!0),e("div",st,[a(ue)?(l(),m(d,{key:0,active:"",currentType:"disabled",class:"disabled-btn"},{default:n(()=>[p(s(a(o)("\u788E\u7247\u4F59\u989D\u4E0D\u8DB3")),1)]),_:1})):i("",!0),a(le)?(l(),m(d,{key:1,active:"",currentType:"disabled",class:"disabled-btn"},{default:n(()=>[p(s(a(o)("DMT\u4F59\u989D\u4E0D\u8DB3")),1)]),_:1})):i("",!0),a(ne)?(l(),m(d,{key:2,onClick:se},{default:n(()=>[p(s(a(o)("\u5408\u6210\u76F2\u76D2")),1)]),_:1})):i("",!0),w.value?(l(),m(d,{key:3,active:"",class:"disabled-btn",style:{color:"#E1C392"}},{default:n(()=>[e("div",ot,[r(M),e("div",ut,s(a(o)("\u5408\u6210\u4E2D"))+"...",1)])]),_:1})):i("",!0),!v.value&&!a(z)?(l(),m(d,{key:4,onClick:Y},{default:n(()=>[p(s(a(o)("\u6388\u6743\u76F2\u76D2")),1)]),_:1})):i("",!0),a(z)?(l(),m(d,{key:5,style:{cursor:"not-allowed"}},{default:n(()=>[e("div",lt,[r(M),e("div",nt,s(a(o)("\u6388\u6743\u4E2D"))+"...",1)])]),_:1})):i("",!0),!b.value&&v.value&&!a(J)?(l(),m(d,{key:6,onClick:ee},{default:n(()=>[p(s(a(o)("\u6388\u6743DTH")),1)]),_:1})):i("",!0),a(J)?(l(),m(d,{key:7,style:{cursor:"not-allowed"}},{default:n(()=>[e("div",it,[r(M),e("div",rt,s(a(o)("\u6388\u6743\u4E2D"))+"...",1)])]),_:1})):i("",!0)]),e("div",ct,[e("span",null,s(a(o)("\u6CA1\u6709\u788E\u7247"))+"\uFF1F",1),e("span",{class:"base-active-text",style:{"text-decoration":"underline",cursor:"pointer"},onClick:E},s(a(o)("\u53BB\u83B7\u5F97")),1)])])]),r(Ve,{show:U.value,onClose:B[0]||(B[0]=H=>U.value=!1),onNavigateTo:oe},null,8,["show"]),r(me,{title:_.value,desc:g.value,show:f.value,type:h.value,onClose:B[1]||(B[1]=H=>f.value=!1),onDescClick:X},null,8,["title","desc","show","type"])])],64))}});var ma=q(dt,[["__scopeId","data-v-404e990a"]]);export{ma as default};
