import{g as A,Z as at}from"./getAssetsFile-567d3cf0.js";import{B as I}from"./Border-43cc6893.js";import{_ as K,B as c,E as st,u as ut,T as nt,R as it,S as rt,U as lt,L as T}from"./index-3ca9b6c8.js";import{T as ct,b as dt}from"./UpgradeNft-086030ed.js";import{u as Q}from"./vue-i18n-9e09b457.js";/* empty css                                                          */import{af as W,aA as i,a3 as d,b1 as n,a6 as t,ad as m,K as e,ac as p,Q as a,r as u,au as G,h,a5 as mt,a4 as l,V as pt,aC as gt,aB as _t}from"./@vue-e2e59b29.js";import{h as vt,l as ft}from"./index-a83cd729.js";import{a as J,b as bt}from"./format-7642b802.js";import{b as ht,a as Bt,g as Ft}from"./GoldCoin-c35e12d1.js";import{f as yt,b as xt,g as Ct}from"./Fragment-a42b4178.js";import{t as Dt}from"./index-23a64008.js";import{u as wt}from"./vue-router-dc311353.js";import"./pinia-c5b88873.js";import"./vue-demi-5b9a0fa5.js";import"./@metamask-0322580d.js";import"./@ethersproject-baa9d35e.js";import"./js-sha3-24137471.js";import"./hash.js-a20011ef.js";import"./minimalistic-assert-c1ce1705.js";import"./inherits-1fe83bc7.js";import"./bech32-9a81277b.js";import"./@walletconnect-6b5bf47d.js";import"./is-typedarray-4f40b03b.js";import"./query-string-2015e57d.js";import"./strict-uri-encode-ecbf5106.js";import"./decode-uri-component-fb3850ff.js";import"./split-on-first-6a113853.js";import"./typedarray-to-buffer-3049f596.js";import"./detect-browser-d6d27bfa.js";import"./qrcode-8475bf43.js";import"./isarray-dd297434.js";import"./buffer-42a74e2f.js";import"./base64-js-f5f6d31b.js";import"./ieee754-b34e253f.js";import"./dijkstrajs-5cebdf0c.js";import"./copy-to-clipboard-792b0d71.js";import"./toggle-selection-eefc0dc5.js";import"./preact-c6b9a0a0.js";import"./process-79043346.js";import"./@intlify-22bbbbdc.js";import"./vue-81a98a43.js";/* empty css                                                         */import"./public-1ae1eec4.js";import"./qs-899482d5.js";import"./side-channel-c89d4eb5.js";import"./get-intrinsic-13ed3457.js";import"./has-symbols-39607a5b.js";import"./function-bind-f4350d04.js";import"./has-c67be6c1.js";import"./call-bind-60ebbe96.js";import"./object-inspect-cc1301a1.js";import"./dayjs-3b7406d5.js";import"./axios-f45f83e3.js";const St={class:"content"},kt={class:"card"},Et={class:"handler"},Tt=W({__name:"SuccessDialog",props:{show:{type:Boolean,default:!1}},emits:["close","navigateTo"],setup(v,{emit:s}){const{t:r}=Q(),B=()=>{s("close")},D=()=>{s("navigateTo")};return(g,w)=>(i(),d(st,{show:v.show,onClose:B,title:e(r)("\u606D\u559C\u83B7\u5F97\u76F2\u76D2")},{default:n(()=>[t("div",St,[t("div",kt,[m(I,{mark:!1,border:!1,img:e(A)("global/blindBxo.gif")},null,8,["img"])]),t("div",Et,[m(c,{onClick:D},{default:n(()=>[p(a(e(r)("\u5F00\u542F\u76F2\u76D2")),1)]),_:1}),t("div",{class:"tips",onClick:B},a(e(r)("\u6211\u77E5\u9053\u4E86")),1)])])]),_:1},8,["show","title"]))}});var At=K(Tt,[["__scopeId","data-v-28cf51da"]]);const It=v=>(gt("data-v-7c241bdc"),v=v(),_t(),v),Nt=p(" \u901A\u8FC7\u6253\u6E38\u620F\u526F\u672C\uFF0C\u6709\u51E0\u7387\u83B7\u5F97\u76F2\u76D2\u788E\u7247\uFF0C\u4F60\u9700\u8981\u5C06\u6E38\u620F\u5185\u76F2\u76D2\u788E\u7247\u63D0\u53D6\u5230\u94B1\u5305\uFF0C\u624D\u53EF\u4EE5\u5C06\u788E\u7247\u5408\u6210\u4E3A\u76F2\u76D2 "),Ut={class:"blind-box"},Ht={class:"top-block"},Lt={class:"base-box"},Vt={class:"info"},$t={class:"need"},Mt={class:"value"},Ot=It(()=>t("div",{class:"item-center"},[t("div",{class:"and-pic"},[t("img",{src:at})])],-1)),Rt={class:"base-box"},Gt={class:"info"},Jt={class:"need"},Kt={class:"value"},Qt={class:"bottom-block"},Wt={class:"base-tips",style:{color:"rgba(230, 241, 255, 0.6500)"}},Zt={class:"base-active-text"},jt={class:"btn-block"},qt={class:"flex"},zt={class:"composeing"},Pt={style:{display:"flex","align-items":"center"}},Xt={style:{"margin-left":"5px"}},Yt={style:{display:"flex","align-items":"center"}},te={style:{"margin-left":"5px"}},ee={class:"base-tips"},oe=W({__name:"Index",setup(v){const{t:s}=Q(),r=ut(),B=wt(),D=()=>{window.open("")},g=u(!1),w=async()=>{const o=await yt(r.address);g.value=o},F=u(!1),Z=async()=>{try{F.value=!0,(await xt()).from&&w(),F.value=!1}catch(o){F.value=!1,console.log("\u6388\u6743\u76F2\u76D2\u5931\u8D25",o)}};G(async()=>{await w(),await N()});const _=u(!1),N=async()=>{const o=await ht(r.address);Number(o.toString())>0?_.value=!0:_.value=!1},y=u(!1),j=async()=>{try{y.value=!0,(await Bt()).from&&N(),y.value=!1}catch(o){y.value=!1,console.log("\u6388\u6743\u5931\u8D25",o)}},S=u(0),q=async()=>{const o=await Ct(r.address);S.value=Number(o.toString())||0},U=u(0),z=async()=>{const o=await Ft(r.address);U.value=J(o)||0},f=u({}),x=u(!1),k=u(!1),H=async()=>{await q(),await z();const o=await vt();o.box_fragment&&(f.value=o,S.value>o.box_fragment&&(x.value=!0),U.value>J(o.coin_amount)&&(k.value=!0))};G(async()=>{await H()});const E=u(!1),b=u(!1),P=async()=>{try{b.value=!0;const o={tokenId:0,userAddress:r.address,orderType:2,coinAmount:String(f.value.coin_amount),goldCoinAmount:String(f.value.goldcoin_amount),boxFragment:String(f.value.box_fragment),starFragment:String(0),targetLevel:0,targetStarRate:0,tokenType:Dt.token_diamond,userSign:""},C=nt(),$=await it(),ot=rt(Number($)),M=await lt(ot,C,o);if(M){o.userSign=M;const O=await ft(o);if(O.data.signature){let R=await dt(O.data);await R.wait(1),R.from&&await H()}}E.value=!0,b.value=!1}catch(o){b.value=!1,console.log("\u5408\u6210\u76F2\u76D2\u5931\u8D25",o)}},X=()=>{B.push("/user?tab=blingBox")},Y=h(()=>!x.value&&_.value&&g.value),tt=h(()=>x.value&&_.value&&g.value&&!k.value),et=h(()=>x.value&&k.value&&g.value&&_.value&&!b.value),L=h(()=>!g.value&&F.value),V=h(()=>!_.value&&y.value);return(o,C)=>(i(),mt(pt,null,[m(ct,null,{default:n(()=>[Nt]),_:1}),t("div",Ut,[t("div",Ht,[t("div",Lt,[t("div",null,[m(I,{mark:!1,border:!1,img:e(A)("pc/blindBox/blindbox.png")},null,8,["img"])]),t("div",Vt,[t("p",$t,a(e(s)("\u5408\u6210\u9700\u8981")),1),t("p",Mt,a(f.value.box_fragment)+a(e(s)("\u76F2\u76D2\u788E\u7247")),1)])]),Ot,t("div",Rt,[t("div",null,[m(I,{mark:!1,border:!1,img:e(A)("pc/blindBox/DMT.png")},null,8,["img"])]),t("div",Gt,[t("p",Jt,a(e(s)("\u5408\u6210\u9700\u8981")),1),t("p",Kt,a(e(bt)(f.value.goldcoin_amount))+"DTH",1)])])]),t("div",Qt,[t("div",null,[t("div",Wt,[p(a(e(s)("\u788E\u7247\u4F59\u989D"))+"\uFF1A",1),t("span",Zt,a(S.value),1)]),l("",!0),t("div",jt,[e(Y)?(i(),d(c,{key:0,active:"",currentType:"disabled",class:"disabled-btn"},{default:n(()=>[p(a(e(s)("\u788E\u7247\u4F59\u989D\u4E0D\u8DB3")),1)]),_:1})):l("",!0),e(tt)?(i(),d(c,{key:1,active:"",currentType:"disabled",class:"disabled-btn"},{default:n(()=>[p(a(e(s)("DMT\u4F59\u989D\u4E0D\u8DB3")),1)]),_:1})):l("",!0),e(et)?(i(),d(c,{key:2,onClick:P},{default:n(()=>[p(a(e(s)("\u5408\u6210\u76F2\u76D2")),1)]),_:1})):l("",!0),b.value?(i(),d(c,{key:3,active:"",class:"disabled-btn",style:{color:"#E1C392"}},{default:n(()=>[t("div",qt,[m(T),t("div",zt,a(e(s)("\u5408\u6210\u4E2D"))+"...",1)])]),_:1})):l("",!0),!g.value&&!e(L)?(i(),d(c,{key:4,onClick:Z},{default:n(()=>[p(a(e(s)("\u6388\u6743\u76F2\u76D2")),1)]),_:1})):l("",!0),e(L)?(i(),d(c,{key:5,style:{cursor:"not-allowed"}},{default:n(()=>[t("div",Pt,[m(T),t("div",Xt,a(e(s)("\u6388\u6743\u4E2D"))+"...",1)])]),_:1})):l("",!0),!_.value&&g.value&&!e(V)?(i(),d(c,{key:6,onClick:j},{default:n(()=>[p(a(e(s)("\u6388\u6743DTH")),1)]),_:1})):l("",!0),e(V)?(i(),d(c,{key:7,style:{cursor:"not-allowed"}},{default:n(()=>[t("div",Yt,[m(T),t("div",te,a(e(s)("\u6388\u6743\u4E2D"))+"...",1)])]),_:1})):l("",!0)]),t("div",ee,[p(a(e(s)("\u6CA1\u6709\u788E\u7247"))+"\uFF1F",1),t("span",{class:"base-active-text",style:{"text-decoration":"underline",cursor:"pointer"},onClick:D},a(e(s)("\u53BB\u83B7\u5F97")),1)])])]),m(At,{show:E.value,onClose:C[0]||(C[0]=$=>E.value=!1),onNavigateTo:X},null,8,["show"])])],64))}});var ao=K(oe,[["__scopeId","data-v-7c241bdc"]]);export{ao as default};
